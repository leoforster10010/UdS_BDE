duckdb.sql("DROP VIEW IF EXISTS q1;")

duckdb.sql("""
CREATE VIEW q1 AS
    select s.bonus
    from seniors as s
    join employees as e on s.employeeId = e.personId
    join persons as pe on e.personId = pe.id
    join photographers as p on e.personId = p.employeeId
    join photos as ph on p.employeeId = ph.photographerId
    join cameras as c on ph.cameraId = c.id
    where c.brand = 'Nikon'
    group by pe.id, pe.firstname, pe.lastname, s.bonus
    having count(ph.id) > 2
    ;
""")

duckdb.sql("DROP VIEW IF EXISTS q2;")

duckdb.sql("""
CREATE VIEW q2 AS
    select distinct c.brand
    from cameras as c
    join photos as ph on c.id = ph.cameraId
    join photographers as p on ph.photographerId = p.employeeId
    join employees as e on p.employeeId = e.personId
    where e.salary > (
        select avg(e.salary)
        from employees as e
    )
    order by c.brand desc
    limit 2
    ;
""")